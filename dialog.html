<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css">

<style>
       
    .styled-select select {
        height: 37px;
        -webkit-appearance: none;
    }
    
    div.top-button-heading {
        padding-bottom: 6px;
    }
    
    div.top-buttons {
        float: left;
        margin-left: -7px;
        padding-right: 20px;
    }
    
    div.indent-first-line {
        float: left;
        padding-top: 15px;
        margin-left: -7px;
    }
    
    div.restore-button {
        clear: both;
        padding-top: 15px;
        margin-left: -7px;
    }
    
    div.bottom-button-update {
        position: absolute;
        top: 190px;
        right: 257px;
    }
    
    div.bottom-button-close {
        position: absolute;
        top: 190px;
        right: 173px;
    }
    
    div.bottom-button-default {
        position: absolute;
        top: 190px;
        right: 0px;
    }
</style>

<!-- Top row of buttons -->

<div class="top-buttons">
    <div class="top-button-heading">
        <b>Size</b>
    </div>
    <div class="styled-select">
        <select id="font_size" name="font_size" onchange="revertDefaultButton();revertRestoreButton();">
                    <option disabled hidden selected>
                        &#8987;
                    </option>

                    <option value="8">
                        8pt
                    </option>

                    <option value="9">
                        9pt
                    </option>

                    <option value="10">
                        10pt
                    </option>

                    <option value="11">
                        11pt
                    </option>

                    <option value="12">
                        12pt
                    </option>

                    <option value="14">
                        14pt
                    </option>

                    <option value="16">
                        16pt
                    </option>

                    <option value="18">
                        18pt
                    </option>
                </select>
    </div>
</div>

<div class="top-buttons">
    <div class="top-button-heading">
        <b>Spacing</b>
    </div>
    <div class="styled-select">
        <select id="line_spacing" onchange="revertDefaultButton();revertRestoreButton();">
                    <option disabled hidden selected>
                        &#8987;
                    </option>

                    <option value="1">
                        Single
                    </option>

                    <option value="1.15">
                        1.15
                    </option>

                    <option value="1.5">
                        1.5
                    </option>

                    <option value="2">
                        Double
                    </option>
                </select>
    </div>
</div>

<div class="top-buttons">
    <div class="top-button-heading">
        <b>Alignment</b>
    </div>
    <div class="styled-select">
        <select id="alignment" onchange="revertDefaultButton();revertRestoreButton();">
                    <option disabled hidden selected>
                        &#8987;
                    </option>

                    <option value="LEFT">
                        Left
                    </option>

                    <option value="RIGHT">
                        Right
                    </option>

                    <option value="CENTER">
                        Center
                    </option>

                    <option value="JUSTIFY">
                        Justify
                    </option>
                </select>
    </div>
</div>

<!-- Indent checkbox -->

<div class="indent-first-line">
    <span> </span>
    <input type="checkbox" id="firstline" value="indent" onchange="revertDefaultButton();revertRestoreButton();">Indent First Line
</div>

<!-- Restore button -->

<div class="restore-button">
    <button id="user_default_restore" onclick="google.script.run.withSuccessHandler(changeRestoreButton).restoreUserDefault($('#font_size').val(), $('#line_spacing').val(), $('#alignment').val(), $('#firstline').prop('checked'));">Restore Default
    </button>
</div>

<!-- Bottom row of buttons -->

<div>

    <div class="bottom-button-default">
        <button id="user_default" onclick="google.script.run.withSuccessHandler(changeDefaultButton).updateUserDefault($('#font_size').val(), $('#line_spacing').val(), $('#alignment').val(), $('#firstline').prop('checked'));">Set as Default
        </button>
    </div>


    <div class="bottom-button-update">
        <button class="action" id="update" onclick="google.script.run.updateDocument($('#font_size').val(), $('#line_spacing').val(), $('#alignment').val(), $('#firstline').prop('checked'));blurUpdateButton();google.script.host.close();">Update
    </button>
    </div>

    <div class="bottom-button-close">
        <button id="close" onclick="google.script.host.close()">Cancel
        </button>
    </div>
</div>



<!-- Javascript -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script>

    google.script.run.withSuccessHandler(updateOptionsDialog).getDocumentSettings();
    
    function changeDefaultButton() {
        document.getElementById('user_default').innerHTML = "Saved as Default";
        document.getElementById('user_default').disabled = true;
        document.getElementById('user_default_restore').disabled = true;
    }

    function revertDefaultButton() {
        document.getElementById('user_default').disabled = false;
        document.getElementById('user_default').innerHTML = "Set as Default";
    }

    function changeRestoreButton(user_default) {
        document.getElementById('user_default').disabled = true;
        document.getElementById('user_default_restore').disabled = true;
        document.getElementById('font_size').value = user_default.size;
        document.getElementById('line_spacing').value = user_default.spacing;
        document.getElementById('alignment').value = user_default.align;
        if (user_default.indented == "true") {
            $('#firstline').prop('checked', true);
        } else {
            $('#firstline').prop('checked', false);
        }
    }

    function revertRestoreButton() {
        document.getElementById('user_default_restore').disabled = false;
    }

    function updateOptionsDialog(document_settings) {
    
        document.getElementById('font_size').value = document_settings.size;
        document.getElementById('line_spacing').value = document_settings.spacing;
        document.getElementById('alignment').value = document_settings.align;
        
        if (document_settings.indented == 'true') {
            $('#firstline').prop('checked', true);
        } else {
            $('#firstline').prop('checked', false);
        }
    }
    
    function blurUpdateButton() {
        document.getElementById('update').blur();
    }
      
</script>
